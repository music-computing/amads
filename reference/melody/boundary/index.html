
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../time/variability/">
      
      
        <link rel="next" href="../contour/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>Boundary - AMADS</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#amads.melody.boundary.boundary" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="AMADS" class="md-header__button md-logo" aria-label="AMADS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AMADS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Boundary
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../paper/" class="md-tabs__link">
        
  
  
    
  
  Project Overview

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../core/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../user_guide/installation/" class="md-tabs__link">
        
  
  
    
  
  Install

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../developer_notes/documentation/" class="md-tabs__link">
          
  
  
  Developer

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="AMADS" class="md-nav__button md-logo" aria-label="AMADS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    AMADS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../paper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Project Overview
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Core
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic Score Elements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics_more/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    More Classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pitch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pitch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../distribution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distribution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Utility Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vector Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Input and Output
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Pitch
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Pitch
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pitch/ismonophonic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ismonophonic
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pitch/hz2midi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hz2midi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pitch/intervals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interval Distributions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pitch/pitches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pitch Distributions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pitch/key/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Key Profiles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pitch/serial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Serial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Time
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Time
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../time/durations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Duration Distributions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../time/meter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Meter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../time/notedensity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Note Density
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../time/rhythm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rhythm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../time/swing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Swing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../time/tempo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tempo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../time/variability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Variability
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" checked>
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Melody
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Melody
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Boundary
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Boundary
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#amads.melody.boundary.boundary" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;boundary
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amads.melody.segment" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;segment
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amads.melody.segment_gestalt" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;segment_gestalt
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amads.melody.similarity.melsim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;melsim
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contour/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contour
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../segment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Segment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../segment_gestalt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Segment gestalt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../similarity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Similarity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Harmony
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Harmony
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../harmony/consonance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Consonance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../harmony/root_finding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Root finding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Polyphony
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Polyphony
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../polyphony/skyline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Skyline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_8" >
        
          
          <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Algorithms
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Algorithms
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/complexity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Complexity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/entropy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Entropy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/gcd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GCD
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/mtype_tokenizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mtype tokenizer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/ngrams/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ngrams
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/nnotes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Nnotes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/norm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Norm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/scale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scale
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/slice/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Slice
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Schemata
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Install
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Developer
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Developer
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_notes/documentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Documentation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_notes/making_a_release/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Making a Release
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_notes/modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Modules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_notes/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_notes/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_notes/style/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Style
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_notes/github/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Github
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_notes/design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_notes/music21/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Music21
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#amads.melody.boundary.boundary" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;boundary
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amads.melody.segment" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;segment
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amads.melody.segment_gestalt" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;segment_gestalt
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amads.melody.similarity.melsim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;melsim
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Boundary</h1>

<div class="doc doc-object doc-function">


<h2 id="amads.melody.boundary.boundary" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">boundary</span>


<a href="#amads.melody.boundary.boundary" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">boundary</span><span class="p">(</span><span class="n"><span title="amads.melody.boundary.boundary(score)">score</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            Score (amads.core.basics.Score)" href="../../basics/#amads.core.basics.Score">Score</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="            Score (amads.core.basics.Score)" href="../../basics/#amads.core.basics.Score">Score</a></span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Compute the local boundary strength with LBDM (Cambouropoulos, 1997).</p>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            –
          <div class="doc-md-description">
            <p>if the score is not monophonic</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="            Score (amads.core.basics.Score)" href="../../basics/#amads.core.basics.Score">Score</a></code>
          –
          <div class="doc-md-description">
            <p>where the notes have the "boundary_strength" property set to a
value from 0 to 1.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>amads/melody/boundary.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">boundary</span><span class="p">(</span><span class="n">score</span><span class="p">:</span> <span class="n">Score</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Score</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the local boundary strength with LBDM (Cambouropoulos, 1997).</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        if the score is not monophonic</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Score</span>
<span class="sd">        where the notes have the &quot;boundary_strength&quot; property set to a</span>
<span class="sd">        value from 0 to 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">score</span><span class="o">.</span><span class="n">ismonophonic</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Score must be monophonic&quot;</span><span class="p">)</span>

    <span class="n">notes</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">get_sorted_notes</span><span class="p">()</span>

    <span class="c1"># profiles</span>
    <span class="n">pp</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">abs</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">key_num</span> <span class="o">-</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">key_num</span><span class="p">)</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">notes</span><span class="p">,</span> <span class="n">notes</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="p">]</span>
    <span class="n">po</span> <span class="o">=</span> <span class="p">[</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">onset</span> <span class="o">-</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">onset</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">notes</span><span class="p">,</span> <span class="n">notes</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
    <span class="n">pr</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">onset</span> <span class="o">-</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">notes</span><span class="p">,</span> <span class="n">notes</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_degrees</span><span class="p">(</span><span class="n">profile</span><span class="p">):</span>
        <span class="n">ret_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">abs</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1e-6</span> <span class="o">+</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">profile</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="p">]</span>
        <span class="n">ret_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret_list</span>

    <span class="c1"># degrees of change</span>
    <span class="n">rp</span> <span class="o">=</span> <span class="n">list_degrees</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span>
    <span class="n">ro</span> <span class="o">=</span> <span class="n">list_degrees</span><span class="p">(</span><span class="n">po</span><span class="p">)</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="n">list_degrees</span><span class="p">(</span><span class="n">pr</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_strengths</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">degrees</span><span class="p">):</span>
        <span class="n">degrees_sum</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">degree_pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">degrees</span><span class="p">,</span> <span class="n">degrees</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="n">degrees_sum</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">degree_pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">degree_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">strengths</span> <span class="o">=</span> <span class="p">[</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">degrees_sum</span><span class="p">)]</span>
        <span class="n">max_strength</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">strengths</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">max_strength</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
            <span class="n">strengths</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">/</span> <span class="n">max_strength</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">strengths</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">strengths</span>

    <span class="n">sp</span> <span class="o">=</span> <span class="n">list_strengths</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">rp</span><span class="p">)</span>
    <span class="n">so</span> <span class="o">=</span> <span class="n">list_strengths</span><span class="p">(</span><span class="n">po</span><span class="p">,</span> <span class="n">ro</span><span class="p">)</span>
    <span class="n">sr</span> <span class="o">=</span> <span class="n">list_strengths</span><span class="p">(</span><span class="n">pr</span><span class="p">,</span> <span class="n">rr</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">notes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;boundary_strength&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">sp_elem</span><span class="p">,</span> <span class="n">so_elem</span><span class="p">,</span> <span class="n">sr_elem</span><span class="p">,</span> <span class="n">note</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">so</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">notes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="n">note</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="s2">&quot;boundary_strength&quot;</span><span class="p">,</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">sp_elem</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">so_elem</span> <span class="o">+</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">sr_elem</span>
        <span class="p">)</span>

        <span class="c1"># b = [1]</span>
        <span class="c1"># for sp_elem, so_elem, sr_elem in zip(sp, so, sr):</span>
        <span class="c1">#    b.append(0.25 * sp_elem + 0.5 * so_elem + 0.25 * sr_elem)</span>
    <span class="c1"># assert len(b) == len(notes)</span>

    <span class="k">return</span> <span class="n">score</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="amads.melody.segment" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">segment</span>


<a href="#amads.melody.segment" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">












<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            fantastic_segmenter (amads.melody.segment.fantastic_segmenter)" href="#amads.melody.segment.fantastic_segmenter">fantastic_segmenter</a></code></b>
            –
            <div class="doc-md-description">
              <p>Segment melody into phrases based on IOI gaps.</p>
            </div>
          </li>
    </ul>





<div class="doc doc-children">








<h3 id="amads.melody.segment-functions">Functions<a href="#amads.melody.segment-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="amads.melody.segment.fantastic_segmenter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">fantastic_segmenter</span>


<a href="#amads.melody.segment.fantastic_segmenter" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">fantastic_segmenter</span><span class="p">(</span>
    <span class="n"><a class="autorefs autorefs-internal" title="score (amads.melody.segment.fantastic_segmenter(score))" href="#amads.melody.segment.fantastic_segmenter(score)">score</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            Score (amads.core.basics.Score)" href="../../basics/#amads.core.basics.Score">Score</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="phrase_gap (amads.melody.segment.fantastic_segmenter(phrase_gap))" href="#amads.melody.segment.fantastic_segmenter(phrase_gap)">phrase_gap</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="units (amads.melody.segment.fantastic_segmenter(units))" href="#amads.melody.segment.fantastic_segmenter(units)">units</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            Score (amads.core.basics.Score)" href="../../basics/#amads.core.basics.Score">Score</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Segment melody into phrases based on IOI gaps.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.segment.fantastic_segmenter(score)" class="doc doc-heading doc-heading-parameter">              <b><code>score</code></b>
<a href="#amads.melody.segment.fantastic_segmenter(score)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-internal" title="            Score (amads.core.basics.Score)" href="../../basics/#amads.core.basics.Score">Score</a></code>)
          –
          <div class="doc-md-description">
            <p>Score object containing melody to segment</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.segment.fantastic_segmenter(phrase_gap)" class="doc doc-heading doc-heading-parameter">              <b><code>phrase_gap</code></b>
<a href="#amads.melody.segment.fantastic_segmenter(phrase_gap)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The minimum IOI gap to consider a new phrase</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.segment.fantastic_segmenter(units)" class="doc doc-heading doc-heading-parameter">              <b><code>units</code></b>
<a href="#amads.melody.segment.fantastic_segmenter(units)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>)
          –
          <div class="doc-md-description">
            <p>The units of the phrase gap, either "seconds" or "quarters"</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-internal" title="            Score (amads.core.basics.Score)" href="../../basics/#amads.core.basics.Score">Score</a>]</code>
          –
          <div class="doc-md-description">
            <p>List of Score objects representing phrases</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>amads/melody/segment.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fantastic_segmenter</span><span class="p">(</span>
    <span class="n">score</span><span class="p">:</span> <span class="n">Score</span><span class="p">,</span> <span class="n">phrase_gap</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">units</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Score</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Segment melody into phrases based on IOI gaps.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    score : Score</span>
<span class="sd">        Score object containing melody to segment</span>
<span class="sd">    phrase_gap : float</span>
<span class="sd">        The minimum IOI gap to consider a new phrase</span>
<span class="sd">    units : str</span>
<span class="sd">        The units of the phrase gap, either &quot;seconds&quot; or &quot;quarters&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list[Score]</span>
<span class="sd">        List of Score objects representing phrases</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">units</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;seconds&quot;</span><span class="p">,</span> <span class="s2">&quot;quarters&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;seconds&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;Seconds are not yet implemented, see issue #75: &quot;</span>
            <span class="s2">&quot;https://github.com/music-computing/amads/issues/75&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;quarters&quot;</span><span class="p">:</span>
        <span class="c1"># Extract notes from score</span>
        <span class="n">notes</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">get_sorted_notes</span><span class="p">()</span>

        <span class="c1"># Create a dictionary to store IOI information</span>
        <span class="n">ioi_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Calculate IOIs</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">note</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">notes</span><span class="p">):</span>
            <span class="c1"># Initialize entry for this note</span>
            <span class="n">ioi_data</span><span class="p">[</span><span class="n">note</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="c1"># first note has no IOI by convention</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ioi_data</span><span class="p">[</span><span class="n">note</span><span class="p">]</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">onset</span> <span class="o">-</span> <span class="n">notes</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">onset</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ioi_data</span><span class="p">[</span><span class="n">note</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">phrases</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_phrase</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">notes</span><span class="p">:</span>
            <span class="c1"># Check whether we need to make a new phrase</span>
            <span class="n">need_new_phrase</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">current_phrase</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
                <span class="ow">and</span> <span class="n">ioi_data</span><span class="p">[</span><span class="n">note</span><span class="p">]</span>
                <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>  <span class="c1"># Check current note&#39;s IOI instead of previous note</span>
                <span class="ow">and</span> <span class="n">ioi_data</span><span class="p">[</span><span class="n">note</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">phrase_gap</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">need_new_phrase</span><span class="p">:</span>
                <span class="c1"># Create new score for the phrase</span>
                <span class="n">phrase_score</span> <span class="o">=</span> <span class="n">Score</span><span class="p">(</span><span class="n">onset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">part</span> <span class="o">=</span> <span class="n">Part</span><span class="p">(</span>
                    <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">onset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span>
                <span class="p">)</span>  <span class="c1"># parent=None is required</span>
                <span class="n">start_time</span> <span class="o">=</span> <span class="n">current_phrase</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">onset</span>
                <span class="c1"># Adjust note timings relative to phrase start</span>
                <span class="k">for</span> <span class="n">phrase_note</span> <span class="ow">in</span> <span class="n">current_phrase</span><span class="p">:</span>
                    <span class="c1"># make a parentless copy of the note so we can adjust its onset</span>
                    <span class="c1"># before inserting it into the new part in proper time order</span>
                    <span class="n">new_note</span> <span class="o">=</span> <span class="n">phrase_note</span><span class="o">.</span><span class="n">insert_copy_into</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                    <span class="n">new_note</span><span class="o">.</span><span class="n">onset</span> <span class="o">-=</span> <span class="n">start_time</span>
                    <span class="n">part</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">new_note</span><span class="p">)</span>
                <span class="n">phrase_score</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>  <span class="c1"># This will set the parent</span>
                <span class="n">phrases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phrase_score</span><span class="p">)</span>
                <span class="n">current_phrase</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">current_phrase</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>

        <span class="c1"># Append final phrase</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_phrase</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">phrase_score</span> <span class="o">=</span> <span class="n">Score</span><span class="p">(</span><span class="n">onset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">part</span> <span class="o">=</span> <span class="n">Part</span><span class="p">(</span>
                <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">onset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span>
            <span class="p">)</span>  <span class="c1"># parent=None is required</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">current_phrase</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">onset</span>
            <span class="k">for</span> <span class="n">phrase_note</span> <span class="ow">in</span> <span class="n">current_phrase</span><span class="p">:</span>
                <span class="n">new_note</span> <span class="o">=</span> <span class="n">phrase_note</span><span class="o">.</span><span class="n">insert_copy_into</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">new_note</span><span class="o">.</span><span class="n">onset</span> <span class="o">-=</span> <span class="n">start_time</span>
                <span class="n">part</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">new_note</span><span class="p">)</span>
            <span class="n">phrase_score</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>  <span class="c1"># This will set the parent</span>
            <span class="n">phrases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phrase_score</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">phrases</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="amads.melody.segment_gestalt" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">segment_gestalt</span>


<a href="#amads.melody.segment_gestalt" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>This module implements the segment gestalt function
by Tenney &amp; Polansky (1980)</p>
<p>We can broadly categorise the algorithm's limitations to 2 categories:</p>
<ol>
<li>
<p>Soft restrictions</p>
</li>
<li>
<p>Hard restrictions on what scores we can take, either because
    the algorithm exhibits undefined behavior when these scores are given,
    or because it isn't designed for said restrictions.</p>
</li>
</ol>
<p>With these categories in mind, we have the following limitations.
The algorithm does not consider these things within its scope
(given a monophonic input):</p>
<ol>
<li>
<p>the monophonic music may have stream segregation
    (i.e. 1 stream of notes can be interpreted as 2 or
    more separate interspersed entities)</p>
</li>
<li>
<p>does not consider harmony or shape (see beginning of section 2
    for the OG paper for more details)</p>
</li>
<li>
<p>does not give semantic meaning (we're still stuck giving
    arbitrary ideals to arbitrary things)</p>
</li>
</ol>
<p>The algorithm has the following restriction to the score:</p>
<ul>
<li>the score must be monophonic (perception differences)
    If we consider polyphonic scores, we will need a definition of what
    a substructure is for said score (in said algorithm) with respect to
    how we carve the note strutures. Since, in this algorithm, we don't
    consider stream segregation and other features that require larger
    context clues, we can just simply define a score substructure
    “temporally” as a contiguous subsequence of notes. Hence, it is safe
    to assume that the current algorithm is undefined when it comes to
    polyphonic music.</li>
</ul>
<p>Some thoughts (and questions):
(1) Should our output preserve the internal structure of the score
for segments and clangs?
Probably not. Keep in mind we're dealing with monophonic score structures.
we just need to provide sufficient information that allows a caller to
potentially verify the result and use it elsewhere, hence we simply
return 2 lists of separate scores.</p>
<p>Legit think having a separate representation that can index into individual
notes will be immensely helpful.
But, I'm certain there has to be something I'm missing to decide otherwise
(if I had to guess, ambiguity of how musical scores themselves are presented to
the musician is chief among them, and maintaining that ambiguity in our internal
representation is also paramount)</p>
<p>Also legit think we need well-defined rules to split and merge scores...</p>
<p>On a completely separate and unrelated note, there are 2 pitchmeans with,
the <em>exact</em> same implementation and 2 filenames...</p>












<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            segment_gestalt (amads.melody.segment_gestalt.segment_gestalt)" href="#amads.melody.segment_gestalt.segment_gestalt">segment_gestalt</a></code></b>
            –
            <div class="doc-md-description">
              <p>Given a monophonic score, returns clang and segment boundary onsets</p>
            </div>
          </li>
    </ul>





<div class="doc doc-children">








<h3 id="amads.melody.segment_gestalt-functions">Functions<a href="#amads.melody.segment_gestalt-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="amads.melody.segment_gestalt.segment_gestalt" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">segment_gestalt</span>


<a href="#amads.melody.segment_gestalt.segment_gestalt" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">segment_gestalt</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="score (amads.melody.segment_gestalt.segment_gestalt(score))" href="#amads.melody.segment_gestalt.segment_gestalt(score)">score</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            Score (amads.core.basics.Score)" href="../../basics/#amads.core.basics.Score">Score</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Given a monophonic score, returns clang and segment boundary onsets</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.segment_gestalt.segment_gestalt(score)" class="doc doc-heading doc-heading-parameter">              <b><code>score</code></b>
<a href="#amads.melody.segment_gestalt.segment_gestalt(score)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-internal" title="            Score (amads.core.basics.Score)" href="../../basics/#amads.core.basics.Score">Score</a></code>)
          –
          <div class="doc-md-description">
            <p>The score to be segmented</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>], <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]]</code>
          –
          <div class="doc-md-description">
            <p>None if no clangs can be formed, else, 2-tuple of:
(sorted list of onsets denoting clangs boundaries,
sorted list of onsets denoting segments segment boundaries)</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#Exception">Exception</a></code>
            –
          <div class="doc-md-description">
            <p>if the score is not monophonic</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>amads/melody/segment_gestalt.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">segment_gestalt</span><span class="p">(</span><span class="n">score</span><span class="p">:</span> <span class="n">Score</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a monophonic score, returns clang and segment boundary onsets</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    score: Score</span>
<span class="sd">        The score to be segmented</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple[list[float], list[float]]</span>
<span class="sd">        None if no clangs can be formed, else, 2-tuple of:</span>
<span class="sd">        (sorted list of onsets denoting clangs boundaries,</span>
<span class="sd">        sorted list of onsets denoting segments segment boundaries)</span>


<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    Exception</span>
<span class="sd">        if the score is not monophonic</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">score</span><span class="o">.</span><span class="n">ismonophonic</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;score not monophonic, input is not valid.&quot;</span><span class="p">)</span>

    <span class="n">notes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Note</span><span class="p">]</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
        <span class="n">List</span><span class="p">[</span><span class="n">Note</span><span class="p">],</span> <span class="n">score</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">collapse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">list_all</span><span class="p">(</span><span class="n">Note</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">([],</span> <span class="p">[])</span>

    <span class="n">cl_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># calculate clang distances here</span>
    <span class="k">for</span> <span class="n">note_pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">notes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">notes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="n">pitch_diff</span> <span class="o">=</span> <span class="n">note_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">key_num</span> <span class="o">-</span> <span class="n">note_pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">key_num</span>
        <span class="n">onset_diff</span> <span class="o">=</span> <span class="n">note_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">onset</span> <span class="o">-</span> <span class="n">note_pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">onset</span>
        <span class="n">cl_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">onset_diff</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pitch_diff</span><span class="p">))</span>

    <span class="c1"># combines the boolean map and the scan function that was done in matlab</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cl_values</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">([],</span> <span class="p">[])</span>

    <span class="n">clang_soft_peaks</span> <span class="o">=</span> <span class="n">_find_peaks</span><span class="p">(</span><span class="n">cl_values</span><span class="p">)</span>
    <span class="n">cl_indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># worry about indices here</span>
    <span class="c1"># starting index here</span>
    <span class="c1"># 1 past the end so we can construct score list easier</span>
    <span class="n">cl_indices</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">clang_soft_peaks</span><span class="p">])</span>
    <span class="n">cl_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">notes</span><span class="p">))</span>

    <span class="n">clang_onsets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="p">(</span><span class="n">notes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">onset</span><span class="p">),</span> <span class="n">cl_indices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">clang_onsets</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">clang_onsets</span><span class="p">,</span> <span class="p">[])</span>

    <span class="c1"># we can probably split the clangs here and organize them into scores</span>
    <span class="n">clang_scores</span> <span class="o">=</span> <span class="n">_construct_score_list</span><span class="p">(</span>
        <span class="n">notes</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cl_indices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">cl_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="p">)</span>
    <span class="c1"># calculate segment boundaries</span>
    <span class="c1"># we need to basically follow segment_gestalt.m</span>
    <span class="c1"># (1) calculate individual clang pitch means</span>
    <span class="n">mean_pitches</span> <span class="o">=</span> <span class="p">[</span><span class="n">pitch_mean</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">clang_scores</span><span class="p">]</span>

    <span class="c1"># (2) calculate segment distances</span>
    <span class="n">seg_dist_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># calculating segment distance...</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">clang_scores</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">local_seg_dist</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="c1"># be careful of the indices when calculating segdist here</span>
        <span class="n">local_seg_dist</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mean_pitches</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean_pitches</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="c1"># first first distance</span>
        <span class="n">local_seg_dist</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="n">notes</span><span class="p">[</span><span class="n">cl_indices</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">onset</span> <span class="o">-</span> <span class="n">notes</span><span class="p">[</span><span class="n">cl_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">onset</span>
        <span class="p">)</span>
        <span class="c1"># first of next clang to last of distance</span>
        <span class="n">local_seg_dist</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span>
            <span class="n">notes</span><span class="p">[</span><span class="n">cl_indices</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">key_num</span>
            <span class="o">-</span> <span class="n">notes</span><span class="p">[</span><span class="n">cl_indices</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">key_num</span>
        <span class="p">)</span>
        <span class="n">local_seg_dist</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">notes</span><span class="p">[</span><span class="n">cl_indices</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">onset</span> <span class="o">-</span> <span class="n">notes</span><span class="p">[</span><span class="n">cl_indices</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">onset</span>
        <span class="p">)</span>
        <span class="n">seg_dist_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">local_seg_dist</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seg_dist_values</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">clang_onsets</span><span class="p">,</span> <span class="p">[])</span>

    <span class="n">seg_soft_peaks</span> <span class="o">=</span> <span class="n">_find_peaks</span><span class="p">(</span><span class="n">seg_dist_values</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">seg_soft_peaks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">cl_indices</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">seg_indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># do we need to add 1 here? where do we add 1</span>
    <span class="c1"># worry about indices here</span>
    <span class="n">seg_indices</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">cl_indices</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">seg_soft_peaks</span><span class="p">])</span>
    <span class="n">seg_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">notes</span><span class="p">))</span>

    <span class="n">segment_onsets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="p">(</span><span class="n">notes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">onset</span><span class="p">),</span> <span class="n">seg_indices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">clang_onsets</span><span class="p">,</span> <span class="n">segment_onsets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="amads.melody.similarity.melsim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">melsim</span>


<a href="#amads.melody.similarity.melsim" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>This is a Python wrapper for the R package <a href="https://github.com/sebsilas/melsim">'melsim'</a>.
This wrapper allows the user to easily interface with the melsim package using the AMADS Score object.
Melsim is a package for computing similarity between melodies, and is being developed by
<a href="https://sebsilas.com/">Sebastian Silas</a> and Klaus Frieler
(<a href="https://www.aesthetics.mpg.de/en/the-institute/people/klaus-frieler.html">https://www.aesthetics.mpg.de/en/the-institute/people/klaus-frieler.html</a>).</p>
<p>Melsim is based on SIMILE, which was written by Daniel Müllensiefen and Klaus Frieler in 2003/2004.
This package is used to compare two or more melodies pairwise across a range of similarity measures.
Not all similarity measures are implemented in melsim, but the ones that are can be used here.
All of the following similarity measures are implemented and functional in melsim:
Please be aware that the names of the similarity measures are case-sensitive.</p>
<table>
<thead>
<tr>
<th>Num</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Jaccard</td>
</tr>
<tr>
<td>2</td>
<td>Kulczynski2</td>
</tr>
<tr>
<td>3</td>
<td>Russel</td>
</tr>
<tr>
<td>4</td>
<td>Faith</td>
</tr>
<tr>
<td>5</td>
<td>Tanimoto</td>
</tr>
<tr>
<td>6</td>
<td>Dice</td>
</tr>
<tr>
<td>7</td>
<td>Mozley</td>
</tr>
<tr>
<td>8</td>
<td>Ochiai</td>
</tr>
<tr>
<td>9</td>
<td>Simpson</td>
</tr>
<tr>
<td>10</td>
<td>cosine</td>
</tr>
<tr>
<td>11</td>
<td>angular</td>
</tr>
<tr>
<td>12</td>
<td>correlation</td>
</tr>
<tr>
<td>13</td>
<td>Tschuprow</td>
</tr>
<tr>
<td>14</td>
<td>Cramer</td>
</tr>
<tr>
<td>15</td>
<td>Gower</td>
</tr>
<tr>
<td>16</td>
<td>Euclidean</td>
</tr>
<tr>
<td>17</td>
<td>Manhattan</td>
</tr>
<tr>
<td>18</td>
<td>supremum</td>
</tr>
<tr>
<td>19</td>
<td>Canberra</td>
</tr>
<tr>
<td>20</td>
<td>Chord</td>
</tr>
<tr>
<td>21</td>
<td>Geodesic</td>
</tr>
<tr>
<td>22</td>
<td>Bray</td>
</tr>
<tr>
<td>23</td>
<td>Soergel</td>
</tr>
<tr>
<td>24</td>
<td>Podani</td>
</tr>
<tr>
<td>25</td>
<td>Whittaker</td>
</tr>
<tr>
<td>26</td>
<td>eJaccard</td>
</tr>
<tr>
<td>27</td>
<td>eDice</td>
</tr>
<tr>
<td>28</td>
<td>Bhjattacharyya</td>
</tr>
<tr>
<td>29</td>
<td>divergence</td>
</tr>
<tr>
<td>30</td>
<td>Hellinger</td>
</tr>
<tr>
<td>31</td>
<td>edit_sim_utf8</td>
</tr>
<tr>
<td>32</td>
<td>edit_sim</td>
</tr>
<tr>
<td>33</td>
<td>Levenshtein</td>
</tr>
<tr>
<td>34</td>
<td>sim_NCD</td>
</tr>
<tr>
<td>35</td>
<td>const</td>
</tr>
<tr>
<td>36</td>
<td>sim_dtw</td>
</tr>
</tbody>
</table>
<p>The following similarity measures are not currently functional in melsim:</p>
<table>
<thead>
<tr>
<th>Num</th>
<th>Name</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>count_distinct</td>
<td>set-based</td>
</tr>
<tr>
<td>2</td>
<td>tversky</td>
<td>set-based</td>
</tr>
<tr>
<td>3</td>
<td>simple matching</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>braun_blanquet</td>
<td>set-based</td>
</tr>
<tr>
<td>5</td>
<td>minkowski</td>
<td>vector-based</td>
</tr>
<tr>
<td>6</td>
<td>ukkon</td>
<td>distribution-based</td>
</tr>
<tr>
<td>7</td>
<td>sum_common</td>
<td>distribution-based</td>
</tr>
<tr>
<td>8</td>
<td>distr_sim</td>
<td>distribution-based</td>
</tr>
<tr>
<td>9</td>
<td>stringdot_utf8</td>
<td>sequence-based</td>
</tr>
<tr>
<td>10</td>
<td>pmi</td>
<td>special</td>
</tr>
<tr>
<td>11</td>
<td>sim_emd</td>
<td>special</td>
</tr>
</tbody>
</table>
<p>Further to the similarity measures, melsim allows the user to specify which domain the
similarity should be calculated for. This is referred to as a “transformation” in melsim,
and all of the following transformations are implemented and functional:</p>
<table>
<thead>
<tr>
<th>Num</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>pitch</td>
</tr>
<tr>
<td>2</td>
<td>int</td>
</tr>
<tr>
<td>3</td>
<td>fuzzy_int</td>
</tr>
<tr>
<td>4</td>
<td>parsons</td>
</tr>
<tr>
<td>5</td>
<td>pc</td>
</tr>
<tr>
<td>6</td>
<td>ioi_class</td>
</tr>
<tr>
<td>7</td>
<td>duration_class</td>
</tr>
<tr>
<td>8</td>
<td>int_X_ioi_class</td>
</tr>
<tr>
<td>9</td>
<td>implicit_harmonies</td>
</tr>
</tbody>
</table>
<p>The following transformations are not currently functional in melsim:</p>
<table>
<thead>
<tr>
<th>Num</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>ioi</td>
</tr>
<tr>
<td>2</td>
<td>phrase_segmentation</td>
</tr>
</tbody>
</table>












<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            run_script_in_r (amads.melody.similarity.melsim.run_script_in_r)" href="#amads.melody.similarity.melsim.run_script_in_r">run_script_in_r</a></code></b>
            –
            <div class="doc-md-description">
              <p>Run an R script and return its output.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            check_r_packages_installed (amads.melody.similarity.melsim.check_r_packages_installed)" href="#amads.melody.similarity.melsim.check_r_packages_installed">check_r_packages_installed</a></code></b>
            –
            <div class="doc-md-description">
              <p>Check if required R packages are installed.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            install_r_package (amads.melody.similarity.melsim.install_r_package)" href="#amads.melody.similarity.melsim.install_r_package">install_r_package</a></code></b>
            –
            <div class="doc-md-description">
              <p>Install an R package.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            install_dependencies (amads.melody.similarity.melsim.install_dependencies)" href="#amads.melody.similarity.melsim.install_dependencies">install_dependencies</a></code></b>
            –
            <div class="doc-md-description">
              <p>Install all required R packages.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            check_python_package_installed (amads.melody.similarity.melsim.check_python_package_installed)" href="#amads.melody.similarity.melsim.check_python_package_installed">check_python_package_installed</a></code></b>
            –
            <div class="doc-md-description">
              <p>Check if a Python package is installed.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            validate_method (amads.melody.similarity.melsim.validate_method)" href="#amads.melody.similarity.melsim.validate_method">validate_method</a></code></b>
            –
            <div class="doc-md-description">
              <p>Validate that the similarity method is supported.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            validate_transformation (amads.melody.similarity.melsim.validate_transformation)" href="#amads.melody.similarity.melsim.validate_transformation">validate_transformation</a></code></b>
            –
            <div class="doc-md-description">
              <p>Validate that the transformation is supported.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            get_similarity (amads.melody.similarity.melsim.get_similarity)" href="#amads.melody.similarity.melsim.get_similarity">get_similarity</a></code></b>
            –
            <div class="doc-md-description">
              <p>Calculate similarity between two Score objects using the specified method.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            score_to_arrays (amads.melody.similarity.melsim.score_to_arrays)" href="#amads.melody.similarity.melsim.score_to_arrays">score_to_arrays</a></code></b>
            –
            <div class="doc-md-description">
              <p>Extract melody attributes from a Score object.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            get_similarities (amads.melody.similarity.melsim.get_similarities)" href="#amads.melody.similarity.melsim.get_similarities">get_similarities</a></code></b>
            –
            <div class="doc-md-description">
              <p>Calculate pairwise similarities between multiple Score objects.</p>
            </div>
          </li>
    </ul>





<div class="doc doc-children">








<h3 id="amads.melody.similarity.melsim-functions">Functions<a href="#amads.melody.similarity.melsim-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="amads.melody.similarity.melsim.run_script_in_r" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">run_script_in_r</span>


<a href="#amads.melody.similarity.melsim.run_script_in_r" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">run_script_in_r</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="script (amads.melody.similarity.melsim.run_script_in_r(script))" href="#amads.melody.similarity.melsim.run_script_in_r(script)">script</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><span title="amads.melody.similarity.melsim.run_script_in_r(text)">text</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Run an R script and return its output.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.run_script_in_r(script)" class="doc doc-heading doc-heading-parameter">              <b><code>script</code></b>
<a href="#amads.melody.similarity.melsim.run_script_in_r(script)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>)
          –
          <div class="doc-md-description">
            <p>R script to run</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
          –
          <div class="doc-md-description">
            <p>Standard output from the R script</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError">RuntimeError</a></code>
            –
          <div class="doc-md-description">
            <p>If there is an error running the R script</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>amads/melody/similarity/melsim.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_script_in_r</span><span class="p">(</span><span class="n">script</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run an R script and return its output.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    script : str</span>
<span class="sd">        R script to run</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        Standard output from the R script</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    RuntimeError</span>
<span class="sd">        If there is an error running the R script</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">_rscript_path</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_rscript_path</span><span class="p">:</span>
        <span class="n">_rscript_path</span> <span class="o">=</span> <span class="n">_find_rscript</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
        <span class="p">[</span><span class="n">_rscript_path</span><span class="p">,</span> <span class="s2">&quot;-e&quot;</span><span class="p">,</span> <span class="n">script</span><span class="p">],</span>
        <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span>
        <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="amads.melody.similarity.melsim.check_r_packages_installed" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">check_r_packages_installed</span>


<a href="#amads.melody.similarity.melsim.check_r_packages_installed" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">check_r_packages_installed</span><span class="p">(</span>
    <span class="n"><a class="autorefs autorefs-internal" title="install_missing (amads.melody.similarity.melsim.check_r_packages_installed(install_missing))" href="#amads.melody.similarity.melsim.check_r_packages_installed(install_missing)">install_missing</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="n_retries (amads.melody.similarity.melsim.check_r_packages_installed(n_retries))" href="#amads.melody.similarity.melsim.check_r_packages_installed(n_retries)">n_retries</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if required R packages are installed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.check_r_packages_installed(install_missing)" class="doc doc-heading doc-heading-parameter">              <b><code>install_missing</code></b>
<a href="#amads.melody.similarity.melsim.check_r_packages_installed(install_missing)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If True, attempt to install missing packages automatically.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.check_r_packages_installed(n_retries)" class="doc doc-heading doc-heading-parameter">              <b><code>n_retries</code></b>
<a href="#amads.melody.similarity.melsim.check_r_packages_installed(n_retries)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>3</code>
)
          –
          <div class="doc-md-description">
            <p>Number of retries for installing each missing package.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ImportError">ImportError</a></code>
            –
          <div class="doc-md-description">
            <p>If required packages are missing and install_missing is False.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError">RuntimeError</a></code>
            –
          <div class="doc-md-description">
            <p>If there is an error checking or installing packages.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>amads/melody/similarity/melsim.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_r_packages_installed</span><span class="p">(</span>
    <span class="n">install_missing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">n_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if required R packages are installed.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    install_missing : bool, default=False</span>
<span class="sd">        If True, attempt to install missing packages automatically.</span>
<span class="sd">    n_retries : int, default=3</span>
<span class="sd">        Number of retries for installing each missing package.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ImportError</span>
<span class="sd">        If required packages are missing and install_missing is False.</span>
<span class="sd">    RuntimeError</span>
<span class="sd">        If there is an error checking or installing packages.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create R script to check package installation using base R only</span>
    <span class="n">check_script</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    packages &lt;- c(</span><span class="si">{packages}</span><span class="s2">)</span>
<span class="s2">    missing &lt;- packages[!sapply(packages, requireNamespace, quietly = TRUE)]</span>
<span class="s2">    if (length(missing) &gt; 0) {{</span>
<span class="s2">        cat(paste0(&#39;&quot;&#39;, missing, &#39;&quot;&#39;, collapse = &quot;,&quot;))</span>
<span class="s2">    }} else {{</span>
<span class="s2">        cat(&quot;&quot;)</span>
<span class="s2">    }}</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1"># Format package list</span>
    <span class="n">packages_str</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">r_cran_packages</span> <span class="o">+</span> <span class="n">r_github_packages</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">check_script</span> <span class="o">=</span> <span class="n">check_script</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">packages</span><span class="o">=</span><span class="n">packages_str</span><span class="p">)</span>

    <span class="c1"># Run R script</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">run_script_in_r</span><span class="p">(</span><span class="n">check_script</span><span class="p">)</span>

        <span class="c1"># Parse the output - if empty, no missing packages</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">output</span><span class="p">:</span>
            <span class="n">missing_packages</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Parse comma-separated quoted strings</span>
            <span class="n">missing_packages</span> <span class="o">=</span> <span class="p">[</span><span class="n">pkg</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">pkg</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">missing_packages</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">install_missing</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">missing_packages</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="n">Retrying</span><span class="p">(</span>
                            <span class="n">stop</span><span class="o">=</span><span class="n">stop_after_attempt</span><span class="p">(</span><span class="n">n_retries</span><span class="p">),</span>
                            <span class="n">wait</span><span class="o">=</span><span class="n">wait_exponential</span><span class="p">(</span><span class="n">multiplier</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
                        <span class="p">):</span>
                            <span class="k">with</span> <span class="n">attempt</span><span class="p">:</span>
                                <span class="n">install_r_package</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>
                    <span class="k">except</span> <span class="n">RetryError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Failed to install R package &#39;</span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2">&#39; after </span><span class="si">{</span><span class="n">n_retries</span><span class="si">}</span><span class="s2"> attempts. &quot;</span>
                            <span class="s2">&quot;See above for the traceback.&quot;</span>
                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Packages </span><span class="si">{</span><span class="n">missing_packages</span><span class="si">}</span><span class="s2"> are required but not installed. &quot;</span>
                    <span class="s2">&quot;You can install them by running: install_dependencies()&quot;</span>
                <span class="p">)</span>
    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error checking R packages: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="amads.melody.similarity.melsim.install_r_package" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">install_r_package</span>


<a href="#amads.melody.similarity.melsim.install_r_package" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">install_r_package</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="package (amads.melody.similarity.melsim.install_r_package(package))" href="#amads.melody.similarity.melsim.install_r_package(package)">package</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Install an R package.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.install_r_package(package)" class="doc doc-heading doc-heading-parameter">              <b><code>package</code></b>
<a href="#amads.melody.similarity.melsim.install_r_package(package)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>)
          –
          <div class="doc-md-description">
            <p>Name of the R package to install.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            –
          <div class="doc-md-description">
            <p>If the package type is unknown.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>amads/melody/similarity/melsim.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">install_r_package</span><span class="p">(</span><span class="n">package</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Install an R package.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    package : str</span>
<span class="sd">        Name of the R package to install.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the package type is unknown.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">r_cran_packages</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Installing CRAN package &#39;</span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>
        <span class="n">install_script</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        utils::chooseCRANmirror(ind=1)</span>
<span class="s2">        utils::install.packages(&quot;</span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2">&quot;, dependencies=TRUE)</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">run_script_in_r</span><span class="p">(</span><span class="n">install_script</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">r_github_packages</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Installing GitHub package &#39;</span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>
        <span class="n">repo</span> <span class="o">=</span> <span class="n">github_repos</span><span class="p">[</span><span class="n">package</span><span class="p">]</span>
        <span class="n">install_script</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        if (!requireNamespace(&quot;remotes&quot;, quietly = TRUE)) </span><span class="se">{{</span>
<span class="s2">            utils::install.packages(&quot;remotes&quot;)</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">        remotes::install_github(&quot;</span><span class="si">{</span><span class="n">repo</span><span class="si">}</span><span class="s2">&quot;, upgrade=&quot;always&quot;, dependencies=TRUE)</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">run_script_in_r</span><span class="p">(</span><span class="n">install_script</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown package type for &#39;</span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="amads.melody.similarity.melsim.install_dependencies" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">install_dependencies</span>


<a href="#amads.melody.similarity.melsim.install_dependencies" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">install_dependencies</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Install all required R packages.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ImportError">ImportError</a></code>
            –
          <div class="doc-md-description">
            <p>If required packages are missing and install_missing is False.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError">RuntimeError</a></code>
            –
          <div class="doc-md-description">
            <p>If there is an error checking or installing packages.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>amads/melody/similarity/melsim.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">install_dependencies</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Install all required R packages.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ImportError</span>
<span class="sd">        If required packages are missing and install_missing is False.</span>
<span class="sd">    RuntimeError</span>
<span class="sd">        If there is an error checking or installing packages.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check which packages need to be installed using base R only</span>
    <span class="n">check_script</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    packages &lt;- c(</span><span class="si">{packages}</span><span class="s2">)</span>
<span class="s2">    missing &lt;- packages[!sapply(packages, requireNamespace, quietly = TRUE)]</span>
<span class="s2">    if (length(missing) &gt; 0) {{</span>
<span class="s2">        cat(paste0(&#39;&quot;&#39;, missing, &#39;&quot;&#39;, collapse = &quot;,&quot;))</span>
<span class="s2">    }} else {{</span>
<span class="s2">        cat(&quot;&quot;)</span>
<span class="s2">    }}</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1"># Check CRAN packages</span>
    <span class="n">packages_str</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">r_cran_packages</span><span class="p">])</span>
    <span class="n">check_script_cran</span> <span class="o">=</span> <span class="n">check_script</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">packages</span><span class="o">=</span><span class="n">packages_str</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">run_script_in_r</span><span class="p">(</span><span class="n">check_script_cran</span><span class="p">)</span>

        <span class="c1"># Parse the output - if empty, no missing packages</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">output</span><span class="p">:</span>
            <span class="n">missing_cran</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Parse comma-separated quoted strings</span>
            <span class="n">missing_cran</span> <span class="o">=</span> <span class="p">[</span><span class="n">pkg</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">pkg</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">missing_cran</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Installing missing CRAN packages...&quot;</span><span class="p">)</span>
            <span class="n">cran_script</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            utils::chooseCRANmirror(ind=1)</span>
<span class="s2">            utils::install.packages(c(</span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">missing_cran</span><span class="p">])</span><span class="si">}</span><span class="s2">), dependencies=TRUE)</span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="n">_</span> <span class="o">=</span> <span class="n">run_script_in_r</span><span class="p">(</span><span class="n">cran_script</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Skipping install: All CRAN packages are already installed.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error checking CRAN packages: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Check GitHub packages</span>
    <span class="n">packages_str</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">r_github_packages</span><span class="p">])</span>
    <span class="n">check_script_github</span> <span class="o">=</span> <span class="n">check_script</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">packages</span><span class="o">=</span><span class="n">packages_str</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">run_script_in_r</span><span class="p">(</span><span class="n">check_script_github</span><span class="p">)</span>

        <span class="c1"># Parse the output - if empty, no missing packages</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">output</span><span class="p">:</span>
            <span class="n">missing_github</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Parse comma-separated quoted strings</span>
            <span class="n">missing_github</span> <span class="o">=</span> <span class="p">[</span><span class="n">pkg</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">pkg</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">missing_github</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Installing missing GitHub packages...&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">missing_github</span><span class="p">:</span>
                <span class="n">repo</span> <span class="o">=</span> <span class="n">github_repos</span><span class="p">[</span><span class="n">package</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Installing </span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">repo</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
                <span class="n">install_script</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                if (!requireNamespace(&quot;remotes&quot;, quietly = TRUE)) </span><span class="se">{{</span>
<span class="s2">                    utils::install.packages(&quot;remotes&quot;)</span>
<span class="s2">                </span><span class="se">}}</span>
<span class="s2">                remotes::install_github(&quot;</span><span class="si">{</span><span class="n">repo</span><span class="si">}</span><span class="s2">&quot;, upgrade=&quot;always&quot;, dependencies=TRUE)</span>
<span class="s2">                &quot;&quot;&quot;</span>
                <span class="n">_</span> <span class="o">=</span> <span class="n">run_script_in_r</span><span class="p">(</span><span class="n">install_script</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Skipping install: All GitHub packages are already installed.&quot;</span>
            <span class="p">)</span>
    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error checking GitHub packages: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All dependencies are installed and up to date.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="amads.melody.similarity.melsim.check_python_package_installed" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">check_python_package_installed</span>


<a href="#amads.melody.similarity.melsim.check_python_package_installed" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">check_python_package_installed</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="package (amads.melody.similarity.melsim.check_python_package_installed(package))" href="#amads.melody.similarity.melsim.check_python_package_installed(package)">package</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if a Python package is installed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.check_python_package_installed(package)" class="doc doc-heading doc-heading-parameter">              <b><code>package</code></b>
<a href="#amads.melody.similarity.melsim.check_python_package_installed(package)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>)
          –
          <div class="doc-md-description">
            <p>Name of the Python package to check.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ImportError">ImportError</a></code>
            –
          <div class="doc-md-description">
            <p>If the package is not installed.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>amads/melody/similarity/melsim.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_python_package_installed</span><span class="p">(</span><span class="n">package</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a Python package is installed.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    package : str</span>
<span class="sd">        Name of the Python package to check.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ImportError</span>
<span class="sd">        If the package is not installed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">__import__</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Package &#39;</span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2">&#39; is required but not installed. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Please install it using pip: pip install </span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="amads.melody.similarity.melsim.validate_method" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">validate_method</span>


<a href="#amads.melody.similarity.melsim.validate_method" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_method</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="method (amads.melody.similarity.melsim.validate_method(method))" href="#amads.melody.similarity.melsim.validate_method(method)">method</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Validate that the similarity method is supported.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.validate_method(method)" class="doc doc-heading doc-heading-parameter">              <b><code>method</code></b>
<a href="#amads.melody.similarity.melsim.validate_method(method)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>)
          –
          <div class="doc-md-description">
            <p>Name of the similarity method to validate.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            –
          <div class="doc-md-description">
            <p>If the method is not supported.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>amads/melody/similarity/melsim.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_method</span><span class="p">(</span><span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate that the similarity method is supported.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    method : str</span>
<span class="sd">        Name of the similarity method to validate.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the method is not supported.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_METHODS</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid method &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39;. Valid methods are: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">VALID_METHODS</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="amads.melody.similarity.melsim.validate_transformation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">validate_transformation</span>


<a href="#amads.melody.similarity.melsim.validate_transformation" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_transformation</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="transformation (amads.melody.similarity.melsim.validate_transformation(transformation))" href="#amads.melody.similarity.melsim.validate_transformation(transformation)">transformation</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Validate that the transformation is supported.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.validate_transformation(transformation)" class="doc doc-heading doc-heading-parameter">              <b><code>transformation</code></b>
<a href="#amads.melody.similarity.melsim.validate_transformation(transformation)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>)
          –
          <div class="doc-md-description">
            <p>Name of the transformation to validate.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            –
          <div class="doc-md-description">
            <p>If the transformation is not supported.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>amads/melody/similarity/melsim.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_transformation</span><span class="p">(</span><span class="n">transformation</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate that the transformation is supported.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    transformation : str</span>
<span class="sd">        Name of the transformation to validate.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the transformation is not supported.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">transformation</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_TRANSFORMATIONS</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid transformation &#39;</span><span class="si">{</span><span class="n">transformation</span><span class="si">}</span><span class="s2">&#39;. Valid transformations are: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">VALID_TRANSFORMATIONS</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="amads.melody.similarity.melsim.get_similarity" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_similarity</span>


<a href="#amads.melody.similarity.melsim.get_similarity" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_similarity</span><span class="p">(</span>
    <span class="n"><a class="autorefs autorefs-internal" title="melody_1 (amads.melody.similarity.melsim.get_similarity(melody_1))" href="#amads.melody.similarity.melsim.get_similarity(melody_1)">melody_1</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="melody_2 (amads.melody.similarity.melsim.get_similarity(melody_2))" href="#amads.melody.similarity.melsim.get_similarity(melody_2)">melody_2</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="method (amads.melody.similarity.melsim.get_similarity(method))" href="#amads.melody.similarity.melsim.get_similarity(method)">method</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="transformation (amads.melody.similarity.melsim.get_similarity(transformation))" href="#amads.melody.similarity.melsim.get_similarity(transformation)">transformation</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate similarity between two Score objects using the specified method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.get_similarity(melody_1)" class="doc doc-heading doc-heading-parameter">              <b><code>melody_1</code></b>
<a href="#amads.melody.similarity.melsim.get_similarity(melody_1)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><span title="Score">Score</span></code>)
          –
          <div class="doc-md-description">
            <p>First Score object containing a monophonic melody</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.get_similarity(melody_2)" class="doc doc-heading doc-heading-parameter">              <b><code>melody_2</code></b>
<a href="#amads.melody.similarity.melsim.get_similarity(melody_2)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><span title="Score">Score</span></code>)
          –
          <div class="doc-md-description">
            <p>Second Score object containing a monophonic melody</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.get_similarity(method)" class="doc doc-heading doc-heading-parameter">              <b><code>method</code></b>
<a href="#amads.melody.similarity.melsim.get_similarity(method)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>)
          –
          <div class="doc-md-description">
            <p>Name of the similarity method to use from the list in the module docstring.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.get_similarity(transformation)" class="doc doc-heading doc-heading-parameter">              <b><code>transformation</code></b>
<a href="#amads.melody.similarity.melsim.get_similarity(transformation)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>)
          –
          <div class="doc-md-description">
            <p>Name of the transformation to use from the list in the module docstring.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
          –
          <div class="doc-md-description">
            <p>Similarity value between the two melodies</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">amads.core.basics</span><span class="w"> </span><span class="kn">import</span> <span class="n">Score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create two simple melodies using from_melody</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">melody_1</span> <span class="o">=</span> <span class="n">Score</span><span class="o">.</span><span class="n">from_melody</span><span class="p">(</span><span class="n">pitches</span><span class="o">=</span><span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">65</span><span class="p">],</span> <span class="n">durations</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">melody_2</span> <span class="o">=</span> <span class="n">Score</span><span class="o">.</span><span class="n">from_melody</span><span class="p">(</span><span class="n">pitches</span><span class="o">=</span><span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">67</span><span class="p">],</span> <span class="n">durations</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate similarity using Jaccard method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">similarity</span> <span class="o">=</span> <span class="n">get_similarity</span><span class="p">(</span><span class="n">melody_1</span><span class="p">,</span> <span class="n">melody_2</span><span class="p">,</span> <span class="s1">&#39;Jaccard&#39;</span><span class="p">,</span> <span class="s1">&#39;pitch&#39;</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>amads/melody/similarity/melsim.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_similarity</span><span class="p">(</span>
    <span class="n">melody_1</span><span class="p">,</span> <span class="n">melody_2</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">transformation</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate similarity between two Score objects using the specified method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    melody_1 : Score</span>
<span class="sd">        First Score object containing a monophonic melody</span>
<span class="sd">    melody_2 : Score</span>
<span class="sd">        Second Score object containing a monophonic melody</span>
<span class="sd">    method : str</span>
<span class="sd">        Name of the similarity method to use from the list in the module docstring.</span>
<span class="sd">    transformation : str</span>
<span class="sd">        Name of the transformation to use from the list in the module docstring.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        Similarity value between the two melodies</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from amads.core.basics import Score</span>
<span class="sd">    &gt;&gt;&gt; # Create two simple melodies using from_melody</span>
<span class="sd">    &gt;&gt;&gt; melody_1 = Score.from_melody(pitches=[60, 62, 64, 65], durations=1.0)</span>
<span class="sd">    &gt;&gt;&gt; melody_2 = Score.from_melody(pitches=[60, 62, 64, 67], durations=1.0)</span>
<span class="sd">    &gt;&gt;&gt; # Calculate similarity using Jaccard method</span>
<span class="sd">    &gt;&gt;&gt; similarity = get_similarity(melody_1, melody_2, &#39;Jaccard&#39;, &#39;pitch&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validate inputs</span>
    <span class="n">validate_method</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
    <span class="n">validate_transformation</span><span class="p">(</span><span class="n">transformation</span><span class="p">)</span>

    <span class="c1"># Convert Score objects to arrays</span>
    <span class="n">pitches1</span><span class="p">,</span> <span class="n">starts1</span><span class="p">,</span> <span class="n">ends1</span> <span class="o">=</span> <span class="n">score_to_arrays</span><span class="p">(</span><span class="n">melody_1</span><span class="p">)</span>
    <span class="n">pitches2</span><span class="p">,</span> <span class="n">starts2</span><span class="p">,</span> <span class="n">ends2</span> <span class="o">=</span> <span class="n">score_to_arrays</span><span class="p">(</span><span class="n">melody_2</span><span class="p">)</span>

    <span class="c1"># Pass lists directly to _get_similarity</span>
    <span class="k">return</span> <span class="n">_get_similarity</span><span class="p">(</span>
        <span class="n">pitches1</span><span class="p">,</span>
        <span class="n">starts1</span><span class="p">,</span>
        <span class="n">ends1</span><span class="p">,</span>
        <span class="n">pitches2</span><span class="p">,</span>
        <span class="n">starts2</span><span class="p">,</span>
        <span class="n">ends2</span><span class="p">,</span>
        <span class="n">method</span><span class="p">,</span>
        <span class="n">transformation</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="amads.melody.similarity.melsim.score_to_arrays" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">score_to_arrays</span>


<a href="#amads.melody.similarity.melsim.score_to_arrays" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">score_to_arrays</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="score (amads.melody.similarity.melsim.score_to_arrays(score))" href="#amads.melody.similarity.melsim.score_to_arrays(score)">score</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Extract melody attributes from a Score object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.score_to_arrays(score)" class="doc doc-heading doc-heading-parameter">              <b><code>score</code></b>
<a href="#amads.melody.similarity.melsim.score_to_arrays(score)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><span title="Score">Score</span></code>)
          –
          <div class="doc-md-description">
            <p>Score object containing a monophonic melody</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>], <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>], <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]]</code>
          –
          <div class="doc-md-description">
            <p>Tuple of (pitches, start_times, end_times)</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>amads/melody/similarity/melsim.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">score_to_arrays</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract melody attributes from a Score object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    score : Score</span>
<span class="sd">        Score object containing a monophonic melody</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Tuple[List[int], List[float], List[float]]</span>
<span class="sd">        Tuple of (pitches, start_times, end_times)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">score</span><span class="o">.</span><span class="n">ismonophonic</span><span class="p">(),</span> <span class="s2">&quot;Score must be monophonic&quot;</span>

    <span class="n">notes</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">get_sorted_notes</span><span class="p">()</span>

    <span class="c1"># Extract onset, pitch, duration for each note</span>
    <span class="n">pitches</span> <span class="o">=</span> <span class="p">[</span><span class="n">note</span><span class="o">.</span><span class="n">pitch</span><span class="o">.</span><span class="n">key_num</span> <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">notes</span><span class="p">]</span>
    <span class="n">starts</span> <span class="o">=</span> <span class="p">[</span><span class="n">note</span><span class="o">.</span><span class="n">onset</span> <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">notes</span><span class="p">]</span>
    <span class="n">ends</span> <span class="o">=</span> <span class="p">[</span><span class="n">note</span><span class="o">.</span><span class="n">onset</span> <span class="o">+</span> <span class="n">note</span><span class="o">.</span><span class="n">duration</span> <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">notes</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">pitches</span><span class="p">,</span> <span class="n">starts</span><span class="p">,</span> <span class="n">ends</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="amads.melody.similarity.melsim.get_similarities" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_similarities</span>


<a href="#amads.melody.similarity.melsim.get_similarities" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_similarities</span><span class="p">(</span>
    <span class="n"><a class="autorefs autorefs-internal" title="scores (amads.melody.similarity.melsim.get_similarities(scores))" href="#amads.melody.similarity.melsim.get_similarities(scores)">scores</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#object">object</a></span><span class="p">],</span>
    <span class="n"><a class="autorefs autorefs-internal" title="method (amads.melody.similarity.melsim.get_similarities(method))" href="#amads.melody.similarity.melsim.get_similarities(method)">method</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Jaccard&quot;</span><span class="p">,</span>
    <span class="n"><a class="autorefs autorefs-internal" title="transformation (amads.melody.similarity.melsim.get_similarities(transformation))" href="#amads.melody.similarity.melsim.get_similarities(transformation)">transformation</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pitch&quot;</span><span class="p">,</span>
    <span class="n"><a class="autorefs autorefs-internal" title="output_file (amads.melody.similarity.melsim.get_similarities(output_file))" href="#amads.melody.similarity.melsim.get_similarities(output_file)">output_file</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n"><a class="autorefs autorefs-internal" title="n_cores (amads.melody.similarity.melsim.get_similarities(n_cores))" href="#amads.melody.similarity.melsim.get_similarities(n_cores)">n_cores</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n"><a class="autorefs autorefs-internal" title="batch_size (amads.melody.similarity.melsim.get_similarities(batch_size))" href="#amads.melody.similarity.melsim.get_similarities(batch_size)">batch_size</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span>
    <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]]</span>
    <span class="o">|</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]]]</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate pairwise similarities between multiple Score objects.</p>
<p>You can provide a single method and transformation, or a list of methods and transformations.
The function will return similarity matrices as nested dictionaries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.get_similarities(scores)" class="doc doc-heading doc-heading-parameter">              <b><code>scores</code></b>
<a href="#amads.melody.similarity.melsim.get_similarities(scores)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="Score">Score</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Dictionary mapping score names to Score objects</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.get_similarities(method)" class="doc doc-heading doc-heading-parameter">              <b><code>method</code></b>
<a href="#amads.melody.similarity.melsim.get_similarities(method)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>, default:
                  <code>&#34;Jaccard&#34;</code>
)
          –
          <div class="doc-md-description">
            <p>Name of the similarity method(s) to use. Can be a single method or a list of methods.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.get_similarities(transformation)" class="doc doc-heading doc-heading-parameter">              <b><code>transformation</code></b>
<a href="#amads.melody.similarity.melsim.get_similarities(transformation)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>, default:
                  <code>&#34;pitch&#34;</code>
)
          –
          <div class="doc-md-description">
            <p>Name of the transformation(s) to use. Can be a single transformation or a list of transformations.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.get_similarities(output_file)" class="doc doc-heading doc-heading-parameter">              <b><code>output_file</code></b>
<a href="#amads.melody.similarity.melsim.get_similarities(output_file)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>If provided, save results to this file. If no extension is provided, .json will be added.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.get_similarities(n_cores)" class="doc doc-heading doc-heading-parameter">              <b><code>n_cores</code></b>
<a href="#amads.melody.similarity.melsim.get_similarities(n_cores)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Number of CPU cores to use for parallel processing. Defaults to all available cores.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h5 id="amads.melody.similarity.melsim.get_similarities(batch_size)" class="doc doc-heading doc-heading-parameter">              <b><code>batch_size</code></b>
<a href="#amads.melody.similarity.melsim.get_similarities(batch_size)" class="headerlink" title="Permanent link">&para;</a></h5>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1000</code>
)
          –
          <div class="doc-md-description">
            <p>Number of comparisons to process in each batch</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]] | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]]]</code>
          –
          <div class="doc-md-description">
            <p>If single method and transformation: nested dictionary similarity
matrix {row_name: {col_name: similarity}} where row_name and col_name
are score names. If multiple methods/transformations: dictionary mapping
(method, transformation) tuples to similarity matrices</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>amads/melody/similarity/melsim.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_similarities</span><span class="p">(</span>
    <span class="n">scores</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">],</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="s2">&quot;Jaccard&quot;</span><span class="p">,</span>
    <span class="n">transformation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="s2">&quot;pitch&quot;</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_cores</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">Dict</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]],</span>
<span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate pairwise similarities between multiple Score objects.</span>

<span class="sd">    You can provide a single method and transformation, or a list of methods and transformations.</span>
<span class="sd">    The function will return similarity matrices as nested dictionaries.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    scores : Dict[str, Score]</span>
<span class="sd">        Dictionary mapping score names to Score objects</span>
<span class="sd">    method : Union[str, List[str]], default=&quot;Jaccard&quot;</span>
<span class="sd">        Name of the similarity method(s) to use. Can be a single method or a list of methods.</span>
<span class="sd">    transformation : Union[str, List[str]], default=&quot;pitch&quot;</span>
<span class="sd">        Name of the transformation(s) to use. Can be a single transformation or a list of transformations.</span>
<span class="sd">    output_file : Union[str, Path], optional</span>
<span class="sd">        If provided, save results to this file. If no extension is provided, .json will be added.</span>
<span class="sd">    n_cores : int, optional</span>
<span class="sd">        Number of CPU cores to use for parallel processing. Defaults to all available cores.</span>
<span class="sd">    batch_size : int, default=1000</span>
<span class="sd">        Number of comparisons to process in each batch</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Union[Dict[str, Dict[str, float]], Dict[Tuple[str, str], Dict[str, Dict[str, float]]]]</span>
<span class="sd">        If single method and transformation: nested dictionary similarity</span>
<span class="sd">        matrix {row_name: {col_name: similarity}} where row_name and col_name</span>
<span class="sd">        are score names. If multiple methods/transformations: dictionary mapping</span>
<span class="sd">        (method, transformation) tuples to similarity matrices</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert single method/transformation to lists</span>
    <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="n">method</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">method</span>
    <span class="n">transformations</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">[</span><span class="n">transformation</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transformation</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">transformation</span>
    <span class="p">)</span>

    <span class="c1"># Validate all methods and transformations</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
        <span class="n">validate_method</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">transformations</span><span class="p">:</span>
        <span class="n">validate_transformation</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need at least 2 Score objects for comparison&quot;</span><span class="p">)</span>

    <span class="c1"># Extract melody data from all scores (avoid multiprocessing due to Score object pickling issues)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extracting melody data...&quot;</span><span class="p">)</span>
    <span class="n">melody_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Processing Score objects&quot;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">melody_data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">score_to_arrays</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Warning: Could not extract melody data for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">melody_data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need at least 2 valid Score objects for comparison&quot;</span><span class="p">)</span>

    <span class="c1"># Prepare arguments for parallel processing</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Computing similarities...&quot;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">score_pairs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Pre-compute all combinations for better performance</span>
    <span class="n">combinations_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="n">melody_data</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">name1</span><span class="p">,</span> <span class="n">data1</span><span class="p">),</span> <span class="p">(</span><span class="n">name2</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">combinations_list</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">transformations</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
                <span class="n">score_pairs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>

    <span class="c1"># Process in larger batches for better performance</span>
    <span class="n">similarities_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Processing batches&quot;</span><span class="p">):</span>
        <span class="n">batch</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">]</span>
        <span class="n">similarities_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">_batch_compute_similarities</span><span class="p">(</span><span class="n">batch</span><span class="p">))</span>

    <span class="c1"># Create dictionary of results</span>
    <span class="n">similarities</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">score_pairs</span><span class="p">,</span> <span class="n">similarities_list</span><span class="p">))</span>

    <span class="c1"># Convert to matrix format using native Python types</span>
    <span class="n">score_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="c1"># Create similarity matrices as nested dictionaries</span>
    <span class="n">matrices</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">transformations</span><span class="p">:</span>
            <span class="c1"># Initialize matrix as nested dictionary with 1s on diagonal</span>
            <span class="n">sim_matrix</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">name1</span> <span class="ow">in</span> <span class="n">score_names</span><span class="p">:</span>
                <span class="n">sim_matrix</span><span class="p">[</span><span class="n">name1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">name2</span> <span class="ow">in</span> <span class="n">score_names</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">name1</span> <span class="o">==</span> <span class="n">name2</span><span class="p">:</span>
                        <span class="n">sim_matrix</span><span class="p">[</span><span class="n">name1</span><span class="p">][</span><span class="n">name2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">sim_matrix</span><span class="p">[</span><span class="n">name1</span><span class="p">][</span><span class="n">name2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="c1"># Fill matrix with pairwise similarities</span>
            <span class="c1"># Since combinations() only gives us each pair once, set both directions</span>
            <span class="k">for</span> <span class="p">(</span>
                <span class="n">name1</span><span class="p">,</span>
                <span class="n">name2</span><span class="p">,</span>
                <span class="n">method_key</span><span class="p">,</span>
                <span class="n">transformation_key</span><span class="p">,</span>
            <span class="p">),</span> <span class="n">similarity</span> <span class="ow">in</span> <span class="n">similarities</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">method_key</span> <span class="o">==</span> <span class="n">m</span> <span class="ow">and</span> <span class="n">transformation_key</span> <span class="o">==</span> <span class="n">t</span><span class="p">:</span>
                    <span class="c1"># Handle NaN values consistently</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="n">similarity</span> <span class="o">==</span> <span class="s2">&quot;NA&quot;</span>
                        <span class="ow">or</span> <span class="n">similarity</span> <span class="ow">is</span> <span class="kc">None</span>
                        <span class="ow">or</span> <span class="p">(</span>
                            <span class="nb">isinstance</span><span class="p">(</span><span class="n">similarity</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
                            <span class="ow">and</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">similarity</span><span class="p">)</span>
                        <span class="p">)</span>
                    <span class="p">):</span>
                        <span class="n">sim_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">sim_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">similarity</span><span class="p">)</span>

                    <span class="c1"># Set both directions to ensure perfect symmetry</span>
                    <span class="n">sim_matrix</span><span class="p">[</span><span class="n">name1</span><span class="p">][</span><span class="n">name2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim_value</span>
                    <span class="n">sim_matrix</span><span class="p">[</span><span class="n">name2</span><span class="p">][</span><span class="n">name1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim_value</span>

            <span class="n">matrices</span><span class="p">[(</span><span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">)]</span> <span class="o">=</span> <span class="n">sim_matrix</span>

    <span class="c1"># Save to file if output file specified</span>
    <span class="k">if</span> <span class="n">output_file</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saving results...&quot;</span><span class="p">)</span>

        <span class="c1"># Ensure output file has .json extension</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">output_file</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">output_file</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">)</span>

        <span class="c1"># Save matrices to JSON</span>
        <span class="n">output_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="n">matrix</span> <span class="ow">in</span> <span class="n">matrices</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">output_data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">matrix</span>

        <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">output_data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Results saved to </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Return format depends on number of method/transformation combinations</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">transformations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Single method and transformation: return just the matrix</span>
        <span class="k">return</span> <span class="n">matrices</span><span class="p">[(</span><span class="n">methods</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">transformations</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Multiple methods/transformations: return dictionary of matrices</span>
        <span class="k">return</span> <span class="n">matrices</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.sections", "navigation.expand", "navigation.tabs"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../javascripts/fix-properties.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>